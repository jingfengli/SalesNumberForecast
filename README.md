# fcMRIModel
In this exercise, I built a random forest model to predict the next month’s unadjusted Canadian retail sales number (label, or the wanted information) *. I collected historical data of several potentially relevant economic features from 1991/01 to 2015/05, including adjusted and unadjusted retail sales numbers [1], stock exchange value [2], Dow-Jones index [2], unemployment [3], and gross domestic product [4]. The general goal is to build a model using the features to predict the label. However, both the label and features (except unemployment) have a general trend of increasing with time, and such data are not ideal for most machine learning models. To remove this trend, I computed the percent change in a given month’s data relative to the previous month. Now, I can build a model in which the features are percent change in various economic indexes and use this model to predict the percent change in unadjusted Canadian retail sales number (the label). The general approach to reach this goal is to use the historical data, where we know the label and the features, as training data to train (or build) a model that captures the generalizable relationship between the features and the label. This model is then used to predict the next month’s label when we only know the features. 


To do so, I used the random forest regression model [5]. Random forest regression is one of the most powerful and popular machine learning techniques, as it has both low bias and low variance and can account for nonlinear relationships between features and labels. Briefly, it first involves generating a large number of ‘new’ training datasets by randomly sampling with replacement from the original training data,. These new training datasets are then used to generate a decision forest, within which a decision tree is built from each new training dataset. Finally, the prediction is computed as the average of the predictions computed using each individual decision tree. In Figure 1, the blue trace shows the actual time series of unadjusted Canadian retail sales numbers, the red trace shows the predicted unadjusted Canadian retail sales number, and the green shading marks the 95% confidence interval of the model’s prediction. In this case, I arbitrarily assumed that 6 years of data is the minimum requirement to perform a prediction of the next month’s sales number, and thus the prediction starts at 1997/01. The prediction explains 98.66% of the variance in the raw data. In almost every case (probability of 0.95), the error in the prediction (the absolute difference between the actual data and the prediction) is less than ~5% of the average sales number. Future directions include collecting longer historical data, adding more relevant features, and adding more decision trees in the forest, each of which would increase the accuracy of the model.

![figure1](https://github.com/jingfengli/SalesNumberForecast/blob/master/Figure1.png "Figure 1")

*: Sales number is in units of 1000 dollars

[1]:http://www5.statcan.gc.ca/cansim/a26?lang=eng&retrLang=eng&id=0800020&paSer=&pattern=&stByVal=1&p1=1&p2=-1&tabMode=dataTable&csid=
[2]:http://www5.statcan.gc.ca/cansim/a26?lang=eng&retrLang=eng&id=1760046&pattern=dow+jones&tabMode=dataTable&srchLan=-1&p1=1&p2=-1
[3]:http://www5.statcan.gc.ca/cansim/a26?lang=eng&retrLang=eng&id=2820047&pattern=unemployment&tabMode=dataTable&srchLan=-1&p1=1&p2=-1
[4]:http://www5.statcan.gc.ca/cansim/a26?lang=eng&retrLang=eng&id=3790031&pattern=gdp&tabMode=dataTable&srchLan=-1&p1=1&p2=-1
[5]:http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html

 

